<!--pages/admin/orders/index.wxml-->
<view class="container">
  <!-- 搜索和筛选区 -->
  <view class="search-bar">
    <view class="search-input">
      <icon type="search" size="14"></icon>
      <input type="text" placeholder="搜索工单号/客户名称" bindinput="onSearchInput" value="{{searchKey}}"/>
    </view>
    <view class="filter-wrap">
      <view class="filter-item" bindtap="showStatusFilter">
        <text>{{currentStatus || '状态'}}</text>
        <text class="arrow">▼</text>
      </view>
      <view class="filter-item" bindtap="showDatePicker">
        <text>{{currentDateRange || '时间'}}</text>
        <text class="arrow">▼</text>
      </view>
    </view>
  </view>

  <!-- 工单列表 -->
  <view class="order-list">
    <view class="order-item" wx:for="{{orders}}" wx:key="id">
      <view class="order-header">
        <view class="left">
          <text class="order-no">{{item.orderNo}}</text>
          <text class="status-tag {{item.status}}">{{item.statusText}}</text>
        </view>
        <text class="create-time">{{item.createTime}}</text>
      </view>
      
      <view class="order-content">
        <view class="info-row">
          <text class="label">客户：</text>
          <text class="value">{{item.customer}}</text>
        </view>
        <view class="info-row">
          <text class="label">设备：</text>
          <text class="value">{{item.equipment}}</text>
        </view>
        <view class="info-row">
          <text class="label">问题：</text>
          <text class="value">{{item.issue}}</text>
        </view>
        <view class="info-row" wx:if="{{item.engineerName}}">
          <text class="label">工程师：</text>
          <text class="value">{{item.engineerName}}</text>
        </view>
      </view>

      <view class="order-footer">
        <button 
          class="action-btn" 
          wx:if="{{item.status === 'pending'}}"
          catchtap="assignEngineer" 
          data-id="{{item.id}}">分配工程师</button>
        <button 
          class="action-btn" 
          catchtap="viewDetail" 
          data-id="{{item.id}}">查看详情</button>
        <button 
          class="action-btn" 
          wx:if="{{item.status === 'processing'}}"
          catchtap="viewProgress" 
          data-id="{{item.id}}">查看进度</button>
      </view>
    </view>
  </view>
</view>