<view class="container">
  <!-- 搜索栏 -->
  <view class="search-bar">
    <view class="search-box">
      <icon type="search" size="16" color="#999"/>
      <input 
        class="search-input"
        placeholder="搜索客户/订单" 
        value="{{keyword}}"
        bindinput="onSearchInput"
        bindconfirm="onSearch"
      />
    </view>
  </view>

  <!-- 工作统计 -->
  <view class="stats-card">
    <view class="stats-item">
      <text class="stats-num">{{stats.todayCount}}</text>
      <text class="stats-label">今日工单</text>
    </view>
    <view class="stats-item">
      <text class="stats-num">{{stats.weekCount}}</text>
      <text class="stats-label">本周工单</text>
    </view>
    <view class="stats-item">
      <text class="stats-num">{{stats.monthCount}}</text>
      <text class="stats-label">本月工单</text>
    </view>
  </view>

  <!-- 今日工单 -->
  <view class="section today-section">
    <view class="section-header">
      <view class="header-left">
        <text class="section-icon">📋</text>
        <text class="section-title">今日工单</text>
      </view>
      <text class="section-count">2个工单</text>
    </view>
    <view class="order-list">
      <view class="order-item" wx:for="{{todayOrders}}" wx:key="id">
        <view class="order-main">
          <view class="order-left">
            <text class="order-no">{{item.orderNo}}</text>
            <text class="order-time">预约：{{item.appointTime}}</text>
          </view>
          <text class="tag {{item.status === 'pending' ? 'tag-warning' : 'tag-primary'}}">
            {{item.statusText}}
          </text>
        </view>
        <view class="order-info">
          <view class="info-row">
            <text class="label">客户：</text>
            <text>{{item.customer}}</text>
          </view>
          <view class="info-row">
            <text class="label">设备：</text>
            <text>{{item.equipment}}</text>
          </view>
          <view class="info-row">
            <text class="label">故障：</text>
            <text>{{item.issue}}</text>
          </view>
          <view class="info-row">
            <text class="label">地点：</text>
            <view class="location-wrap">
              <text>{{item.location}}</text>
              <view class="copy-btn" catchtap="copyLocation" data-location="{{item.location}}">
                复制
              </view>
            </view>
          </view>
        </view>
        <view class="order-actions">
          <button class="btn btn-outline" bindtap="makeCall" data-phone="{{item.phone}}">
            联系客户
          </button>
          <button class="btn btn-primary" bindtap="startOrder" data-id="{{item.id}}" wx:if="{{item.status === 'pending'}}">
            开始处理
          </button>
        </view>
      </view>
    </view>
  </view>

  <!-- 可抢工单 -->
  <view class="section grab-section">
    <view class="section-header">
      <view class="header-left">
        <text class="section-icon">🔔</text>
        <text class="section-title">可抢工单</text>
      </view>
      <text class="section-count">3个工单</text>
    </view>
    <view class="order-list">
      <view class="order-item" wx:for="{{grabOrders}}" wx:key="id">
        <view class="order-main">
          <view class="order-left">
            <text class="order-no">{{item.orderNo}}</text>
            <text class="order-time">{{item.createTime}}</text>
          </view>
          <text class="tag tag-warning">待抢单</text>
        </view>
        <view class="order-info">
          <view class="info-row">
            <text class="label">客户：</text>
            <text>{{item.customer}}</text>
          </view>
          <view class="info-row">
            <text class="label">设备：</text>
            <text>{{item.equipment}}</text>
          </view>
          <view class="info-row">
            <text class="label">故障：</text>
            <text>{{item.issue}}</text>
          </view>
          <view class="info-row">
            <text class="label">地点：</text>
            <view class="location-wrap">
              <text>{{item.location}}</text>
              <text class="distance">{{item.distance}}km</text>
            </view>
          </view>
        </view>
        <view class="order-actions">
          <button class="btn btn-primary" bindtap="grabOrder" data-id="{{item.id}}">
            抢单
          </button>
        </view>
      </view>
    </view>
  </view>
</view> 